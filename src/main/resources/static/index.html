<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .user-info {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ccc;
            display: inline-block;
            min-width: 300px;
        }
        h2 {
            margin-top: 0;
        }
        p {
            margin: 5px 0;
        }
    </style>
</head>
<body>
<h1>登录成功</h1>
<p>欢迎进入 Smart Campus</p>

<div class="user-info" id="user-info">
    <p>正在加载用户信息...</p>
</div>

<script>
    const token = localStorage.getItem('token'); // 登录后存储的 JWT

    if (!token) {
        document.getElementById('user-info').innerHTML = '<p style="color:red;">未检测到登录信息，请重新登录</p>';
    } else {
        fetch(`/api/auth/user-info?token=${token}`)
            .then(response => {
                if (!response.ok) throw new Error('获取用户信息失败');
                return response.json();
            })
            .then(user => {
                const div = document.getElementById('user-info');
                let html = `<h2>用户信息</h2>
                        <p><strong>用户名：</strong>${user.username}</p>
                        <p><strong>真实姓名：</strong>${user.realName}</p>
                        <p><strong>邮箱：</strong>${user.email || '-'}</p>
                        <p><strong>电话：</strong>${user.phone || '-'}</p>
                        <p><strong>身份：</strong>${user.userType}</p>`;

                // 根据用户类型展示不同字段
                if (user.userType === 'STUDENT') {
                    html += `<hr>
                         <p><strong>学号：</strong>${user.studentId || '-'}</p>
                         <p><strong>院系：</strong>${user.department || '-'}</p>
                         <p><strong>专业：</strong>${user.major || '-'}</p>
                         <p><strong>年级：</strong>${user.grade || '-'}</p>
                         <p><strong>班级：</strong>${user.className || '-'}</p>`;
                } else if (user.userType === 'TEACHER') {
                    html += `<hr>
                         <p><strong>工号：</strong>${user.teacherId || '-'}</p>
                         <p><strong>职称：</strong>${user.title || '-'}</p>`;
                } else if (user.userType === 'ADMIN') {
                    html += `<hr>
                         <p>管理员用户，无额外信息</p>`;
                }

                div.innerHTML = html;
            })
            .catch(error => {
                document.getElementById('user-info').innerHTML = `<p style="color:red;">${error.message}</p>`;
            });
    }
</script>
</body>
</html>
